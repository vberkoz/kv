---
import Layout from '../../layouts/Layout.astro';
---

<Layout title="API Reference - KV Storage">
  <div class="max-w-4xl mx-auto px-4 py-16">
    <nav class="mb-8">
      <a href="/docs" class="text-blue-600 hover:underline">‚Üê Back to Docs</a>
    </nav>

    <h1 class="text-4xl font-bold mb-4">API Reference</h1>
    <p class="text-xl text-gray-600 mb-8">Complete documentation of all endpoints</p>

    <div class="prose prose-lg max-w-none">
      <h2 class="text-2xl font-bold mb-4">Authentication</h2>
      <p class="mb-6">
        All API requests require authentication using an API key in the Authorization header:
      </p>
      <pre class="bg-gray-900 text-white p-4 rounded overflow-x-auto mb-8"><code>Authorization: Bearer YOUR_API_KEY</code></pre>

      <h2 class="text-2xl font-bold mb-4">Base URL</h2>
      <pre class="bg-gray-900 text-white p-4 rounded overflow-x-auto mb-8"><code>https://api.kv.vberkoz.com</code></pre>

      <hr class="my-8" />

      <h2 class="text-3xl font-bold mb-6">Endpoints</h2>

      <div class="mb-12">
        <h3 class="text-2xl font-bold mb-3">PUT /v1/&#123;namespace&#125;/&#123;key&#125;</h3>
        <p class="mb-4">Store or update a value</p>
        
        <h4 class="font-bold mb-2">Headers</h4>
        <ul class="mb-4">
          <li><code set:html="Authorization: Bearer {apiKey}"></code></li>
          <li><code>Content-Type: application/json</code></li>
        </ul>

        <h4 class="font-bold mb-2">Request Body</h4>
        <pre class="bg-gray-900 text-white p-4 rounded overflow-x-auto mb-4"><code set:html={`{
  "value": any
}`}></code></pre>

        <h4 class="font-bold mb-2">Response</h4>
        <p class="mb-2"><strong>201 Created</strong></p>
        <pre class="bg-gray-900 text-white p-4 rounded overflow-x-auto mb-4"><code set:html={`{
  "message": "Value stored successfully"
}`}></code></pre>

        <h4 class="font-bold mb-2">Example</h4>
        <pre class="bg-gray-900 text-white p-4 rounded overflow-x-auto"><code set:html={`curl -X PUT "https://api.kv.vberkoz.com/v1/myapp/config" \\
  -H "Authorization: Bearer YOUR_API_KEY" \\
  -H "Content-Type: application/json" \\
  -d '{"value": {"theme": "dark", "lang": "en"}}'`}></code></pre>
      </div>

      <div class="mb-12">
        <h3 class="text-2xl font-bold mb-3">GET /v1/&#123;namespace&#125;/&#123;key&#125;</h3>
        <p class="mb-4">Retrieve a value</p>
        
        <h4 class="font-bold mb-2">Headers</h4>
        <ul class="mb-4">
          <li><code set:html="Authorization: Bearer {apiKey}"></code></li>
        </ul>

        <h4 class="font-bold mb-2">Response</h4>
        <p class="mb-2"><strong>200 OK</strong></p>
        <pre class="bg-gray-900 text-white p-4 rounded overflow-x-auto mb-4"><code set:html={`{
  "value": any
}`}></code></pre>

        <p class="mb-2"><strong>404 Not Found</strong></p>
        <pre class="bg-gray-900 text-white p-4 rounded overflow-x-auto mb-4"><code set:html={`{
  "error": "Key not found"
}`}></code></pre>

        <h4 class="font-bold mb-2">Example</h4>
        <pre class="bg-gray-900 text-white p-4 rounded overflow-x-auto"><code>curl "https://api.kv.vberkoz.com/v1/myapp/config" \\
  -H "Authorization: Bearer YOUR_API_KEY"</code></pre>
      </div>

      <div class="mb-12">
        <h3 class="text-2xl font-bold mb-3">DELETE /v1/&#123;namespace&#125;/&#123;key&#125;</h3>
        <p class="mb-4">Delete a value</p>
        
        <h4 class="font-bold mb-2">Headers</h4>
        <ul class="mb-4">
          <li><code set:html="Authorization: Bearer {apiKey}"></code></li>
        </ul>

        <h4 class="font-bold mb-2">Response</h4>
        <p class="mb-2"><strong>200 OK</strong></p>
        <pre class="bg-gray-900 text-white p-4 rounded overflow-x-auto mb-4"><code set:html={`{
  "message": "Value deleted successfully"
}`}></code></pre>

        <h4 class="font-bold mb-2">Example</h4>
        <pre class="bg-gray-900 text-white p-4 rounded overflow-x-auto"><code>curl -X DELETE "https://api.kv.vberkoz.com/v1/myapp/config" \\
  -H "Authorization: Bearer YOUR_API_KEY"</code></pre>
      </div>

      <div class="mb-12">
        <h3 class="text-2xl font-bold mb-3">GET /v1/namespaces</h3>
        <p class="mb-4">List all namespaces</p>
        
        <h4 class="font-bold mb-2">Headers</h4>
        <ul class="mb-4">
          <li><code set:html="Authorization: Bearer {token}"></code> (JWT from login)</li>
        </ul>

        <h4 class="font-bold mb-2">Response</h4>
        <pre class="bg-gray-900 text-white p-4 rounded overflow-x-auto"><code set:html={`{
  "namespaces": [
    {"name": "myapp", "createdAt": "2024-01-01T00:00:00Z"}
  ]
}`}></code></pre>
      </div>

      <div class="mb-12">
        <h3 class="text-2xl font-bold mb-3">GET /v1/&#123;namespace&#125;</h3>
        <p class="mb-4">List keys in a namespace (supports prefix filtering)</p>
        
        <h4 class="font-bold mb-2">Query Parameters</h4>
        <ul class="mb-4">
          <li><code>prefix</code> (optional) - Filter keys by prefix</li>
        </ul>

        <h4 class="font-bold mb-2">Response</h4>
        <pre class="bg-gray-900 text-white p-4 rounded overflow-x-auto"><code set:html={`{
  "keys": ["user:123", "user:456"]
}`}></code></pre>
      </div>

      <hr class="my-8" />

      <h2 class="text-2xl font-bold mb-4">Rate Limits</h2>
      <ul class="mb-6">
        <li><strong>Free:</strong> 100,000 requests/month</li>
        <li><strong>Pro:</strong> 1,000,000 requests/month</li>
        <li><strong>Scale:</strong> 10,000,000 requests/month</li>
      </ul>

      <p class="mb-6">When rate limit is exceeded, you'll receive a <code>429 Too Many Requests</code> response.</p>

      <h2 class="text-2xl font-bold mb-4">Error Codes</h2>
      <ul class="mb-6">
        <li><code>400</code> - Bad Request (invalid JSON or parameters)</li>
        <li><code>401</code> - Unauthorized (invalid API key)</li>
        <li><code>404</code> - Not Found (key doesn't exist)</li>
        <li><code>429</code> - Too Many Requests (rate limit exceeded)</li>
        <li><code>500</code> - Internal Server Error</li>
      </ul>
    </div>
  </div>
</Layout>
